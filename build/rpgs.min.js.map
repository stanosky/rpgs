{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1e3b7626e22853a8405c","webpack:///./src/index.js","webpack:///./src/rpgs/core/BaseNode.js","webpack:///./src/rpgs/core/Utils.js","webpack:///./src/rpgs/core/Plug.js","webpack:///./src/rpgs/core/ConnectorManager.js","webpack:///./src/rpgs/core/Connector.js","webpack:///./src/rpgs/core/ParamsManager.js","webpack:///./src/rpgs/core/CompoundNode.js","webpack:///./src/rpgs/core/ErrorCode.js","webpack:///./src/rpgs/core/ErrorHandler.js","webpack:///./src/rpgs/dialogs/AnswerNode.js","webpack:///./src/rpgs/dialogs/DialogNode.js","webpack:///./src/rpgs/dialogs/DialogWalker.js","webpack:///./src/rpgs/dialogs/TalkNode.js","webpack:///./src/rpgs/RPGSystem.js","webpack:///./src/rpgs/core/NodePool.js","webpack:///./src/rpgs/core/NodeFactory.js","webpack:///./src/rpgs/core/NodeCreator.js"],"names":["module","exports","BaseNode","require","CompoundNode","Connector","ConnectorManager","ErrorCode","ErrorHandler","ParamsManager","Plug","Utils","AnswerNode","DialogNode","DialogWalker","TalkNode","RPGSystem","_uuid","WeakMap","_label","_x","_y","getRandomLabel","prefix","id","substr","nodePool","data","_data","set","uuid","getUUID","className","constructor","name","indexOf","label","get","x","y","pm","params","cm","_init","setData","addConnector","VISIBLE","ENABLED","type","value","addParam","getParamValue","setParamValue","removeParam","class","getId","getLabel","wires","getData","getParams","childId","index","canRecieveWire","nodeId","addWire","getWires","removeWire","dispose","delete","UUID","self","lut","i","toString","generate","d0","Math","random","d1","d2","d3","indexOfObject","array","obj","length","getIndexById","addObjectToArray","push","removeObjectFromArray","spliced","splice","GOTO","_connectors","parsed","connector","nodes","hasOwnProperty","getConnector","map","n","limit","connectors","alreadyExist","filter","c","getType","canAddWire","_type","_limit","_wires","isNaN","parseInt","getLimit","wireLen","wire","_params","_paramExist","paramName","containerObj","keys","Object","k","_addParam","paramType","paramValue","isMandatory","mand","undefined","param","getParam","_children","children","getChildren","removeNode","newIndex","len","oldIndex","NODE_NOT_EXISTS","CLASS_NOT_DEFINED","CONNECTION_TO_ITSELF","IMPROPER_CONNECTION","OBJECT_NOT_FOUND","MANDATORY_PARAM","INCORRECT_TYPE","INCORRECT_PARENT_NODE","INCORRECT_LINK_TARGET","INCOMPATIBLE_CHILD","_logger","_setLogger","logger","_showMsg","errorCode","msg","node","node1","node2","child","parent","Error","setLogger","showMsg","_text","text","getText","_start","startTalk","getStartTalk","setStartTalk","talkId","getChild","childExist","_currTalk","_rpgs","_dialog","rpgs","findNode","dialogId","dialog","reset","talk","conversation","currTalk","options","answerId","answer","active","isActive","enabled","isVisible","currId","answerNode","getTalk","setTalk","_errorHandler","_nodePool","_nodeFactory","_nodeCreator","_mergeNodes","forEach","d","addNode","createNode","_setData","clearData","JSON","parse","mergeNodes","addDialog","addTalk","addAnswer","getNodes","serialize","NodePool","errorHandler","_objectPool","_findNode","_addNode","_removeNode","isNodeFound","_getNodesByClass","_getNodes","slice","_getData","_clearData","_serialize","stringify","NodeFactory","_createNode","NodeCreator","nodeFactory","_lastChild","_parentHistory","_tempWires","_setConnection","nodeId1","nodeId2","targetNode","referenceNode","canBeWiredTo","_getWaitingWiresForNode","asChild","createChildNode","nodeParams","addChild","canAddChild","unshift","shift","_addDialog","_addTalk","_addAnswer","_addWire","referenceNodeId"],"mappings":"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","file":"rpgs.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"rpgs\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rpgs\"] = factory();\n\telse\n\t\troot[\"rpgs\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1e3b7626e22853a8405c","module.exports = {\r\n  BaseNode: require('./rpgs/core/BaseNode'),\r\n  CompoundNode: require('./rpgs/core/CompoundNode'),\r\n  Connector: require('./rpgs/core/Connector'),\r\n  ConnectorManager: require('./rpgs/core/ConnectorManager'),\r\n  ErrorCode: require('./rpgs/core/ErrorCode'),\r\n  ErrorHandler: require('./rpgs/core/ErrorHandler'),\r\n  ParamsManager: require('./rpgs/core/ParamsManager'),\r\n  Plug: require('./rpgs/core/Plug'),\r\n  Utils: require('./rpgs/core/Utils'),\r\n  AnswerNode: require('./rpgs/dialogs/AnswerNode'),\r\n  DialogNode: require('./rpgs/dialogs/DialogNode'),\r\n  DialogWalker: require('./rpgs/dialogs/DialogWalker'),\r\n  TalkNode: require('./rpgs/dialogs/TalkNode'),\r\n  RPGSystem: require('./rpgs/RPGSystem')\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/index.js","'use strict';\r\nimport Utils from './Utils';\r\nimport Plug from './Plug';\r\nimport ConnectorManager from './ConnectorManager';\r\nimport ParamsManager from './ParamsManager';\r\n\r\nlet BaseNode = (function () {\r\n\r\n  // Weak maps are new feature to JavaScript. We can store private\r\n  // object properties in key/value pairs using our instance as the key,\r\n  // and our class can capture those key/value maps in a closure.\r\n  let _uuid = new WeakMap();\r\n  let _label = new WeakMap();\r\n  let _x = new WeakMap();\r\n  let _y = new WeakMap();\r\n\r\n  const getRandomLabel = (prefix, id) => prefix + id.substr(0, 4);\r\n  /* function executeScript(rpgs, scriptId) {\r\n    let _script = rpgs.findNode(scriptId);\r\n\r\n    return _script !== null && _script.execute ? _script.execute({rpgs: rpgs}) : true;\r\n  }*/\r\n\r\n  return class BaseNode {\r\n    constructor(nodePool, data) {\r\n      let _data = data || {};\r\n\r\n      // console.log('BaseNode', nodePool);\r\n      // If uuid not present, then by default we assign Universally Unique ID.\r\n      _uuid.set(this, _data.uuid ? _data.uuid : Utils.getUUID());\r\n\r\n      let className = this.constructor.name;\r\n      let prefix = className.substr(0, className.indexOf('Node')) + '-';\r\n\r\n      _label.set(this, _data.label ?\r\n        _data.label : getRandomLabel(prefix, _uuid.get(this)));\r\n      _x.set(this, _data.x ? _data.x : 0);\r\n      _y.set(this, _data.y ? _data.y : 0);\r\n      this.nodePool = nodePool;\r\n      this.pm = new ParamsManager(_data.params || {});\r\n      this.cm = new ConnectorManager();\r\n      this._init();\r\n      this.cm.setData(_data);\r\n    }\r\n\r\n    _init() {\r\n      this.cm.addConnector(Plug.VISIBLE, 1);\r\n      this.cm.addConnector(Plug.ENABLED, 1);\r\n    }\r\n\r\n    addParam(name, type, value) {\r\n      this.pm.addParam(name, type, value);\r\n    }\r\n\r\n    getParam(name) {\r\n      return this.pm.getParamValue(name);\r\n    }\r\n\r\n    setParam(name, value) {\r\n      this.pm.setParamValue(name, value);\r\n    }\r\n\r\n    removeParam(name) {\r\n      this.pm.removeParam(name);\r\n    }\r\n\r\n    setId(value) {\r\n      _uuid.set(this, value);\r\n    }\r\n\r\n    getId() {\r\n      return _uuid.get(this);\r\n    }\r\n\r\n    setLabel(value) {\r\n      _label.set(this, value);\r\n    }\r\n\r\n    getLabel() {\r\n      return _label.get(this);\r\n    }\r\n\r\n    set x(value) {\r\n      _x.set(this, value);\r\n    }\r\n\r\n    get x() {\r\n      return _x.get(this);\r\n    }\r\n\r\n    set y(value) {\r\n      _y.set(this, value);\r\n    }\r\n\r\n    get y() {\r\n      return _y.get(this);\r\n    }\r\n\r\n    /**\r\n     * Returns visibility state.\r\n     * @return {boolean} Visibility state\r\n     */\r\n    isVisible() {\r\n      return true;// executeScript(this.rpgs, this.cm.getWires(Plug.VISIBLE)[0]);\r\n    }\r\n\r\n    /**\r\n     * Returns activity state.\r\n     * @return {boolean} Active state\r\n     */\r\n    isActive() {\r\n      return true;// executeScript(this.rpgs, this.cm.getWires(Plug.ENABLED)[0]);\r\n    }\r\n\r\n    getData() {\r\n      return {\r\n        class: this.constructor.name,\r\n        uuid: this.getId(),\r\n        label: this.getLabel(),\r\n        wires: this.cm.getData(),\r\n        params: this.pm.getParams(),\r\n        x: this.x,\r\n        y: this.y\r\n      };\r\n    }\r\n\r\n    canAddChild(type) {\r\n      // false because cannot have children\r\n      return false;\r\n    }\r\n\r\n    addChild(childId) {\r\n      // empty because cannot have children\r\n    }\r\n\r\n    removeChild(index) {\r\n      // empty because cannot have children\r\n    }\r\n\r\n    getChild(index) {\r\n      // null because cannot have children\r\n      return null;\r\n    }\r\n\r\n    getChildren() {\r\n      // empty array because cannot have children\r\n      return [];\r\n    }\r\n\r\n    canBeWiredTo(type) {\r\n      return false;\r\n    }\r\n\r\n    canRecieveWire(type) {\r\n      return this.cm.canRecieveWire(type);\r\n    }\r\n\r\n    addWire(type, nodeId) {\r\n      this.cm.addWire(type, nodeId);\r\n    }\r\n\r\n    getWires(type) {\r\n      return this.cm.getWires(type);\r\n    }\r\n\r\n    removeWire(type, nodeId) {\r\n      this.cm.removeWire(type, nodeId);\r\n    }\r\n\r\n    dispose() {\r\n      // console.log('dispose from BaseNode');\r\n      this.cm.dispose();\r\n      this.pm.dispose();\r\n      this.cm = null;\r\n      this.pm = null;\r\n      this.nodePool = null;\r\n      _uuid.delete(this);\r\n      _label.delete(this);\r\n      _x.delete(this);\r\n      _y.delete(this);\r\n    }\r\n  };\r\n})();\r\n\r\nmodule.exports = BaseNode;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/BaseNode.js","'use strict';\r\n\r\n/**\r\n * Fast UUID generator, RFC4122 version 4 compliant.\r\n * @author Jeff Ward (jcward.com).\r\n * @license MIT license\r\n * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\r\n **/\r\nvar UUID = (function () {\r\n  var self = {};\r\n  var lut = [];\r\n  var i;\r\n\r\n  for (i = 0; i < 256; i++) {\r\n    lut[i] = (i < 16 ? '0' : '') + (i).toString(16);\r\n  }\r\n\r\n  self.generate = function () {\r\n    var d0 = Math.random() * 0xffffffff | 0;\r\n    var d1 = Math.random() * 0xffffffff | 0;\r\n    var d2 = Math.random() * 0xffffffff | 0;\r\n    var d3 = Math.random() * 0xffffffff | 0;\r\n\r\n    return lut[d0 & 0xff] + lut[d0 >> 8 & 0xff] + lut[d0 >> 16 & 0xff] +\r\n      lut[d0 >> 24 & 0xff] + '-' + lut[d1 & 0xff] + lut[d1 >> 8 & 0xff] + '-' +\r\n      lut[d1 >> 16 & 0x0f | 0x40] + lut[d1 >> 24 & 0xff] + '-' +\r\n      lut[d2 & 0x3f | 0x80] + lut[d2 >> 8 & 0xff] + '-' + lut[d2 >> 16 & 0xff] +\r\n      lut[d2 >> 24 & 0xff] + lut[d3 & 0xff] + lut[d3 >> 8 & 0xff] +\r\n      lut[d3 >> 16 & 0xff] + lut[d3 >> 24 & 0xff];\r\n  };\r\n\r\n  return self;\r\n})();\r\n\r\nexports.getUUID = UUID.generate;\r\n\r\nlet indexOfObject = function (array, obj) {\r\n  var i;\r\n\r\n  for (i = 0; i < array.length; i++) {\r\n    if (array[i] === obj) return i;\r\n  }\r\n  return -1;\r\n};\r\n\r\nexports.indexOfObject = indexOfObject;\r\n\r\nlet getIndexById = function (array, id) {\r\n  var i;\r\n\r\n  for (i = 0; i < array.length; i++) {\r\n    if (array[i].getId() === id) return i;\r\n  }\r\n  return -1;\r\n};\r\n\r\nexports.getIndexById = getIndexById;\r\n\r\nexports.addObjectToArray = function (array, obj) {\r\n  if (indexOfObject(array, obj) === -1) {\r\n    array.push(obj);\r\n  }\r\n  return array;\r\n};\r\n\r\nexports.removeObjectFromArray = function (array, obj) {\r\n  let index = indexOfObject(array, obj);\r\n\r\n  if (index !== -1) {\r\n    let spliced = array.splice(index, 1);\r\n\r\n    if (spliced.dispose) spliced.dispose();\r\n  }\r\n  return array;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/Utils.js","'use strict';\r\n\r\nconst VISIBLE = 'visible';\r\nconst ENABLED = 'enabled';\r\nconst GOTO = 'goto';\r\n\r\nexports.VISIBLE = VISIBLE;\r\nexports.ENABLED = ENABLED;\r\nexports.GOTO = GOTO;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/Plug.js","'use strict';\r\nimport Connector from './Connector';\r\n\r\nlet ConnectorManager = (function () {\r\n\r\n  let _connectors = new WeakMap();\r\n\r\n  return class ConnectorManager {\r\n\r\n    constructor() {\r\n      _connectors.set(this, []);\r\n    }\r\n\r\n    setData(data) {\r\n      let wires = data.wires || {};\r\n      let parsed = [];\r\n      let connector, nodes;\r\n\r\n      for (let type in wires) {\r\n        if (wires.hasOwnProperty(type)) {\r\n          connector = this.getConnector(type);\r\n          if (connector !== null) {\r\n            nodes = wires[type];\r\n            nodes.map(n => connector.addWire(n));\r\n            parsed.push(connector);\r\n          }\r\n        }\r\n      }\r\n      return parsed;\r\n    }\r\n\r\n    addConnector(type, limit) {\r\n      let connectors = _connectors.get(this);\r\n      let alreadyExist = connectors.filter(c => c.getType() === type).length > 0;\r\n\r\n      if (!alreadyExist) {\r\n        connectors.push(new Connector(type, limit));\r\n        _connectors.set(this, connectors);\r\n      }\r\n    }\r\n\r\n    getConnector(type) {\r\n      let connectors = _connectors.get(this) || null;\r\n      let connector = null;\r\n\r\n      if (connectors !== null) {\r\n        connector = connectors.filter(c => c.getType() === type);\r\n      }\r\n      return connector !== null && connector.length > 0 ? connector[0] : null;\r\n    }\r\n\r\n    canRecieveWire(type) {\r\n      let connectors = _connectors.get(this);\r\n\r\n      return connectors.filter(c => {\r\n        return c.getType() === type && c.canAddWire();\r\n      }).length > 0;\r\n    }\r\n\r\n    addWire(type, nodeId) {\r\n      let connector = this.getConnector(type);\r\n\r\n      if (connector !== null) {\r\n        connector.addWire(nodeId);\r\n      }\r\n    }\r\n\r\n    getWires(type) {\r\n      let connector = this.getConnector(type);\r\n\r\n      return connector !== null ? connector.getWires() : [];\r\n    }\r\n\r\n    removeWire(type, nodeId) {\r\n      let connector = this.getConnector(type);\r\n\r\n      if (connector !== null) {\r\n        connector.removeWire(nodeId);\r\n      }\r\n    }\r\n\r\n    getData() {\r\n      let data = {};\r\n      let connectors = _connectors.get(this) || [];\r\n      let type, nodes, i;\r\n\r\n      for (i = 0; i < connectors.length; i++) {\r\n        type = connectors[i].getType();\r\n        nodes = connectors[i].getWires();\r\n        data[type] = nodes;\r\n      }\r\n      return data;\r\n    }\r\n\r\n    dispose() {\r\n      _connectors.get(this).map((c) => { c.dispose(); });\r\n      _connectors.delete(this);\r\n    }\r\n  };\r\n})();\r\n\r\nmodule.exports = ConnectorManager;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/ConnectorManager.js","'use strict';\r\n\r\nlet Connector = (function () {\r\n  let _type = new WeakMap();\r\n  let _limit = new WeakMap();\r\n  let _wires = new WeakMap();\r\n\r\n  return class Connector {\r\n\r\n    constructor(type, limit) {\r\n      _type.set(this, type);\r\n      _limit.set(this, isNaN(parseInt(limit, 10)) ? -1 : parseInt(limit, 10));\r\n      _wires.set(this, []);\r\n    }\r\n\r\n    getType() {\r\n      return _type.get(this);\r\n    }\r\n\r\n    getLimit() {\r\n      return _limit.get(this);\r\n    }\r\n\r\n    getWires() {\r\n      return _wires.get(this);\r\n    }\r\n\r\n    canAddWire() {\r\n      let limit = this.getLimit();\r\n      let wireLen = this.getWires().length;\r\n\r\n      return limit === -1 || (limit > 0 && wireLen < limit);\r\n    }\r\n\r\n    addWire(nodeId) {\r\n      let wire = this.getWires();\r\n\r\n      if (this.canAddWire()) {\r\n        wire.push(nodeId);\r\n        _wires.set(this, wire);\r\n      }\r\n    }\r\n\r\n    removeWire(nodeId) {\r\n      _wires.set(this, _wires.get(this).filter(wire => {\r\n        return wire !== nodeId;\r\n      }));\r\n    }\r\n\r\n    dispose() {\r\n      _type.delete(this);\r\n      _limit.delete(this);\r\n      _wires.delete(this);\r\n    }\r\n  };\r\n})();\r\n\r\nmodule.exports = Connector;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/Connector.js","'use strict';\r\n\r\nlet ParamsManager = (function () {\r\n  let _params = new WeakMap();\r\n\r\n  function _paramExist(paramName, containerObj) {\r\n    let keys = Object.keys(containerObj);\r\n\r\n    return keys.filter(k => k === paramName).length > 0;\r\n  }\r\n\r\n  function _addParam(paramName, paramType, paramValue, containerObj, isMandatory) {\r\n    if (!_paramExist(paramName, containerObj)) {\r\n      containerObj[paramName] = {\r\n        type: paramType,\r\n        value: paramValue,\r\n        mand: isMandatory\r\n      };\r\n    } else {\r\n      // console.warn();\r\n    }\r\n    return containerObj;\r\n  }\r\n\r\n  return class ParamsManager {\r\n    constructor(data) {\r\n      _params.set(this, data || {});\r\n    }\r\n\r\n    addMandatoryParam(name, type, value) {\r\n      _params.set(this, _addParam(name, type, value, _params.get(this), true));\r\n    }\r\n\r\n    addParam(name, type, value) {\r\n      _params.set(this, _addParam(name, type, value, _params.get(this), false));\r\n    }\r\n\r\n    getParam(name) {\r\n      let params = _params.get(this);\r\n\r\n      return params[name] !== undefined ? params[name] : null;\r\n    }\r\n\r\n    getParamValue(name) {\r\n      let param = this.getParam(name);\r\n\r\n      return param !== null ? param.value : null;\r\n    }\r\n\r\n    setParamValue(name, value) {\r\n      let params = _params.get(this);\r\n\r\n      if (params[name] !== undefined) params[name].value = value;\r\n    }\r\n\r\n    removeParam(name) {\r\n      let param = this.getParam(name);\r\n      let params = _params.get(this);\r\n\r\n      if (param !== null && !param.mand) {\r\n        delete params[name];\r\n        _params.set(this, params);\r\n      }\r\n    }\r\n\r\n    getParams() {\r\n      return _params.get(this);\r\n    }\r\n\r\n    dispose() {\r\n      _params.delete(this);\r\n    }\r\n  };\r\n})();\r\n\r\nmodule.exports = ParamsManager;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/ParamsManager.js","'use strict';\r\nimport BaseNode from '../core/BaseNode';\r\nimport Utils from '../core/Utils';\r\n\r\nlet CompoundNode = (function () {\r\n\r\n  let _children = new WeakMap();\r\n\r\n  return class CompoundNode extends BaseNode {\r\n\r\n    constructor(nodePool, data) {\r\n      super(nodePool, data);\r\n      _children.set(this, data && data.children ? data.children : []);\r\n    }\r\n\r\n    getData() {\r\n      let data = super.getData();\r\n\r\n      data.children = this.getChildren();\r\n      return data;\r\n    }\r\n\r\n    addChild(childId) {\r\n      let children = _children.get(this);\r\n\r\n      _children.set(this, Utils.addObjectToArray(children, childId));\r\n    }\r\n\r\n    removeChild(index) {\r\n      let children = _children.get(this);\r\n\r\n      if (index >= 0 && index < children.length) {\r\n        this.nodePool.removeNode(children[index]);\r\n        children.splice(index, 1);\r\n        _children.set(this, children);\r\n      }\r\n    }\r\n\r\n    getChild(index) {\r\n      let children = _children.get(this);\r\n\r\n      return children.length > index ? children[index] : null;\r\n    }\r\n\r\n    getChildren() {\r\n      return _children.get(this);\r\n    }\r\n\r\n    setChildIndex(childId, newIndex) {\r\n      let children = this.getChildren();\r\n      let len = children.length;\r\n      let oldIndex = children.indexOf(childId);\r\n\r\n      if (oldIndex < 0) return;\r\n      newIndex = newIndex < 0 ? 0 : (newIndex >= len ? len - 1 : newIndex);\r\n      children.splice(newIndex, 0, children.splice(oldIndex, 1)[0]);\r\n    }\r\n\r\n    dispose() {\r\n      // console.log('dispose from CompoundNode');\r\n      _children.get(this).map(childId => {\r\n        this.nodePool.removeNode(childId);\r\n      });\r\n      _children.delete(this);\r\n      super.dispose();\r\n    }\r\n\r\n  };\r\n})();\r\n\r\nmodule.exports = CompoundNode;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/CompoundNode.js","'use strict';\r\n\r\nconst NODE_NOT_EXISTS = 0;\r\nconst CLASS_NOT_DEFINED = 1;\r\nconst CONNECTION_TO_ITSELF = 2;\r\nconst IMPROPER_CONNECTION = 3;\r\nconst OBJECT_NOT_FOUND = 4;\r\nconst MANDATORY_PARAM = 5;\r\nconst INCORRECT_TYPE = 6;\r\nconst INCORRECT_PARENT_NODE = 7;\r\nconst INCORRECT_LINK_TARGET = 8;\r\nconst INCOMPATIBLE_CHILD = 9;\r\n\r\nexports.NODE_NOT_EXISTS = NODE_NOT_EXISTS;\r\nexports.CLASS_NOT_DEFINED = CLASS_NOT_DEFINED;\r\nexports.CONNECTION_TO_ITSELF = CONNECTION_TO_ITSELF;\r\nexports.IMPROPER_CONNECTION = IMPROPER_CONNECTION;\r\nexports.OBJECT_NOT_FOUND = OBJECT_NOT_FOUND;\r\nexports.MANDATORY_PARAM = MANDATORY_PARAM;\r\nexports.INCORRECT_TYPE = INCORRECT_TYPE;\r\nexports.INCORRECT_PARENT_NODE = INCORRECT_PARENT_NODE;\r\nexports.INCORRECT_LINK_TARGET = INCORRECT_LINK_TARGET;\r\nexports.INCOMPATIBLE_CHILD = INCOMPATIBLE_CHILD;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/ErrorCode.js","'use strict';\r\n\r\nimport ErrorCode from './ErrorCode';\r\n\r\n\r\nlet ErrorHandler = function () {\r\n\r\n  let _logger = null;\r\n\r\n  function _setLogger(logger) {\r\n    _logger = logger;\r\n  }\r\n\r\n  function _showMsg(errorCode, params) {\r\n    let msg = '';\r\n\r\n    switch (errorCode) {\r\n      case ErrorCode.NODE_NOT_EXISTS:\r\n        msg = `Node of type ${params.type} is not defined.`;\r\n        break;\r\n      case ErrorCode.CLASS_NOT_DEFINED:\r\n        msg = `Class ${params.class} is not defined.`;\r\n        break;\r\n      case ErrorCode.CONNECTION_TO_ITSELF:\r\n        msg = `Cannot connect node \"${params.node}\" to itself.`;\r\n        break;\r\n      case ErrorCode.IMPROPER_CONNECTION:\r\n        msg = `Cannot create connection of type \"${params.type}\"` +\r\n        ` from node id \"${params.node1}\" to node id \"${params.node2}\".`;\r\n        break;\r\n      case ErrorCode.OBJECT_NOT_FOUND:\r\n        msg = `Cannot find object with id \"${params.id}\"`;\r\n        break;\r\n      case ErrorCode.MANDATORY_PARAM:\r\n        msg = `Parameter \"${params.param}\" was expected but instead got undefined.`;\r\n        break;\r\n      case ErrorCode.INCORRECT_TYPE:\r\n        msg = `Wrong type of argument. Expected \"${params.type}\"`;\r\n        break;\r\n      case ErrorCode.INCORRECT_PARENT_NODE:\r\n        msg = `Node of type \"${params.child}\" can be added only to \"${params.parent}\" node.`;\r\n        break;\r\n      case ErrorCode.INCORRECT_LINK_TARGET:\r\n        msg = `Cannot create link connection to null node.`;\r\n        break;\r\n      case ErrorCode.INCOMPATIBLE_CHILD:\r\n        msg = `Cannot add child of type \"${params.child}\" into parent of type \"${params.parent}\".`;\r\n        break;\r\n      default:\r\n        msg = `Unknown error code passed: ${errorCode}`;\r\n    }\r\n    if (_logger) {\r\n      _logger(msg);\r\n    } else {\r\n      throw new Error(msg);\r\n      // add warning mode?\r\n    }\r\n  }\r\n\r\n  return {\r\n    setLogger: _setLogger,\r\n    showMsg: _showMsg\r\n  };\r\n};\r\n\r\nmodule.exports = ErrorHandler;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/ErrorHandler.js","'use strict';\r\nimport BaseNode from '../core/BaseNode';\r\nimport Plug from '../core/Plug';\r\n\r\nlet AnswerNode = (function () {\r\n  // Weak maps are new feature to JavaScript. We can store private\r\n  // object properties in key/value pairs using our instance as the key,\r\n  // and our class can capture those key/value maps in a closure.\r\n  let _text = new WeakMap();\r\n\r\n  return class AnswerNode extends BaseNode {\r\n    constructor(nodePool, data) {\r\n      super(nodePool, data);\r\n      _text.set(this, data && data.text ? data.text : '');\r\n    }\r\n\r\n    _init() {\r\n      super._init();\r\n      this.cm.addConnector(Plug.GOTO, 1);\r\n    }\r\n\r\n    getData() {\r\n      let data = super.getData();\r\n\r\n      data.text = this.getText();\r\n      return data;\r\n    }\r\n\r\n    setText(value) {\r\n      _text.set(this, value);\r\n    }\r\n\r\n    getText() {\r\n      return _text.get(this);\r\n    }\r\n\r\n    getTalk() {\r\n      return this.getWires(Plug.GOTO)[0];\r\n    }\r\n\r\n    dispose() {\r\n      // console.log('dispose from AnswerNode');\r\n      _text.delete(this);\r\n      super.dispose();\r\n    }\r\n\r\n  };\r\n})();\r\n\r\nmodule.exports = AnswerNode;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/dialogs/AnswerNode.js","'use strict';\r\nimport CompoundNode from '../core/CompoundNode';\r\n\r\nlet DialogNode = (function () {\r\n\r\n  let _start = new WeakMap();\r\n\r\n  return class DialogNode extends CompoundNode {\r\n\r\n    constructor(nodePool, data) {\r\n      super(nodePool, data);\r\n      _start.set(this, data && data.startTalk ? data.startTalk : '');\r\n    }\r\n\r\n    getData() {\r\n      let data = super.getData();\r\n\r\n      data.startTalk = this.getStartTalk();\r\n      return data;\r\n    }\r\n\r\n    canAddChild(type) {\r\n      return type === 'TalkNode';\r\n    }\r\n\r\n    addChild(childId) {\r\n      super.addChild(childId);\r\n      let children = this.getChildren();\r\n\r\n      if (children.length === 1) this.setStartTalk(childId);\r\n    }\r\n\r\n    removeChild(index) {\r\n      let talkId = this.getChild(index);\r\n      let startTalk = this.getStartTalk();\r\n\r\n      super.removeChild(index);\r\n      if (talkId === startTalk) {\r\n        this.setStartTalk('');\r\n      }\r\n    }\r\n\r\n    setStartTalk(talkId) {\r\n      // should only add talk nodes from internal children list\r\n      let children = this.getChildren();\r\n      let childExist = children.indexOf(talkId) > -1;\r\n\r\n      if (childExist) {\r\n        _start.set(this, talkId);\r\n      } else if (children[0] !== undefined) {\r\n        _start.set(this, children[0]);\r\n      } else {\r\n        _start.set(this, '');\r\n      }\r\n    }\r\n\r\n    getStartTalk() {\r\n      return _start.get(this);\r\n    }\r\n\r\n    dispose() {\r\n      // console.log('dispose from DialogNode');\r\n      _start.delete(this);\r\n      super.dispose();\r\n    }\r\n  };\r\n})();\r\n\r\nmodule.exports = DialogNode;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/dialogs/DialogNode.js","'use strict';\r\n\r\nlet DialogWalker = (function () {\r\n  let _currTalk = new WeakMap();\r\n  let _rpgs = new WeakMap();\r\n  let _dialog = new WeakMap();\r\n\r\n  return class DialogWalker {\r\n    constructor(rpgs) {\r\n      if (!(rpgs && rpgs.findNode)) {\r\n        throw new Error('RPGSystem instance not passed to constructor.');\r\n      }\r\n      _rpgs.set(this, rpgs);\r\n      _dialog.set(this, null);\r\n      _currTalk.set(this, null);\r\n    }\r\n\r\n    setDialog(dialogId) {\r\n      let dialog = _rpgs.get(this).findNode(dialogId);\r\n\r\n      if (dialog === null || !dialog.getStartTalk) {\r\n        throw new Error(`DialogNode with the id \"${dialogId}\" does not exists.`);\r\n      }\r\n      _dialog.set(this, dialog);\r\n      this.reset();\r\n    }\r\n\r\n    setTalk(talkId) {\r\n      let talk = _rpgs.get(this).findNode(talkId);\r\n\r\n      if (talk === null) {\r\n        throw new Error(`TalkNode with the id \"${talkId}\" does not exists.`);\r\n      }\r\n      _currTalk.set(this, talk);\r\n    }\r\n\r\n    getConversation() {\r\n      let conversation = {};\r\n      let currTalk = _currTalk.get(this);\r\n      let children = currTalk ? currTalk.getChildren() : [];\r\n\r\n      conversation.text = currTalk ? currTalk.getText() : '';\r\n      conversation.options = children.map((answerId) => {\r\n        let answer = _rpgs.get(this).findNode(answerId);\r\n\r\n        return {\r\n          id: answer.getId(),\r\n          text: answer.getText(),\r\n          active: answer.isActive(),\r\n          enabled: answer.isVisible()\r\n        };\r\n      });\r\n      return conversation;\r\n    }\r\n\r\n    // should return boolean that indicates if there is next talk\r\n    selectOption(id) {\r\n      let children = _currTalk.get(this).getChildren();\r\n      let answerId = children.filter((currId, index, array) => {\r\n        return currId === id;\r\n      });\r\n\r\n      if (answerId[0] !== undefined) {\r\n        let answerNode = _rpgs.get(this).findNode(answerId[0]);\r\n        let talkId;\r\n\r\n        if (answerNode !== null) {\r\n          talkId = answerNode.getTalk();\r\n          if (talkId !== undefined) {\r\n            this.setTalk(talkId);\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n\r\n    reset() {\r\n      let dialog = _dialog.get(this);\r\n\r\n      if (dialog !== null) {\r\n        this.setTalk(dialog.getStartTalk());\r\n      }\r\n    }\r\n  };\r\n})();\r\n\r\nmodule.exports = DialogWalker;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/dialogs/DialogWalker.js","'use strict';\r\nimport CompoundNode from '../core/CompoundNode';\r\n\r\nlet TalkNode = (function () {\r\n\r\n  let _text = new WeakMap();\r\n\r\n  return class TalkNode extends CompoundNode {\r\n    constructor(nodePool, data) {\r\n      super(nodePool, data);\r\n      _text.set(this, data && data.text ? data.text : '');\r\n    }\r\n\r\n    getData() {\r\n      let data = super.getData();\r\n\r\n      data.text = this.getText();\r\n      return data;\r\n    }\r\n\r\n    setText(value) {\r\n      _text.set(this, value);\r\n    }\r\n\r\n    getText() {\r\n      return _text.get(this);\r\n    }\r\n\r\n    canAddChild(type) {\r\n      return type === 'AnswerNode';\r\n    }\r\n\r\n    canBeWiredTo(type) {\r\n      return type === 'goto';\r\n    }\r\n\r\n    dispose() {\r\n      // console.log('dispose from TalkNode');\r\n      _text.delete(this);\r\n      super.dispose();\r\n    }\r\n  };\r\n})();\r\n\r\nmodule.exports = TalkNode;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/dialogs/TalkNode.js","/**\r\n * Role-Playing Game System\r\n * @author Krzysztof Stano (stanosky)\r\n * @license MIT license\r\n * @link https://github.com/stanosky/rpgs\r\n * @version 1.0.0rc\r\n **/\r\n\r\n'use strict';\r\nimport ErrorHandler from './core/ErrorHandler';\r\nimport NodePool from './core/NodePool';\r\nimport NodeFactory from './core/NodeFactory';\r\nimport NodeCreator from './core/NodeCreator';\r\n\r\nconst RPGSystem = function () {\r\n\r\n  const _errorHandler = new ErrorHandler();\r\n  const _nodePool = new NodePool(_errorHandler);\r\n  const _nodeFactory = new NodeFactory(_nodePool, _errorHandler);\r\n  const _nodeCreator = new NodeCreator(_nodePool, _nodeFactory, _errorHandler);\r\n\r\n  function _mergeNodes(data) {\r\n    data.forEach((d) => {\r\n      _nodePool.removeNode(d.uuid);\r\n      _nodePool.addNode(_nodeFactory.createNode(d));\r\n    });\r\n  }\r\n\r\n  function _setData(data) {\r\n    let _data = data || '[]';\r\n\r\n    _nodePool.clearData();\r\n    _mergeNodes(JSON.parse(_data));\r\n  }\r\n\r\n  function _setLogger(logger) {\r\n    _errorHandler.setLogger(logger);\r\n  }\r\n\r\n  return {\r\n    setData: _setData,\r\n    setLogger: _setLogger,\r\n    mergeNodes: _mergeNodes,\r\n\r\n    addDialog: _nodeCreator.addDialog,\r\n    addTalk: _nodeCreator.addTalk,\r\n    addAnswer: _nodeCreator.addAnswer,\r\n    addWire: _nodeCreator.addWire,\r\n    addNode: _nodeCreator.addNode,\r\n\r\n    findNode: _nodePool.findNode,\r\n    removeNode: _nodePool.removeNode,\r\n    getNodes: _nodePool.getNodes,\r\n    getData: _nodePool.getData,\r\n    clearData: _nodePool.clearData,\r\n    serialize: _nodePool.serialize,\r\n    toString: _nodePool.serialize  // it is just alias of serialize\r\n  };\r\n};\r\n\r\nmodule.exports = RPGSystem;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/RPGSystem.js","'use strict';\r\nimport Utils from './Utils';\r\n// import ErrorCode from './core/ErrorCode';\r\n\r\nconst NodePool = function (errorHandler) {\r\n  // const _errorHandler = errorHandler;\r\n  let _objectPool = [];\r\n\r\n  function _findNode(nodeId) {\r\n    var i;\r\n\r\n    for (i = 0; i < _objectPool.length; i++) {\r\n      if (_objectPool[i].getId() === nodeId) return _objectPool[i];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  function _addNode(node) {\r\n    if (!node.getId) return; // _errorHandler.showMsg();\r\n    _objectPool.push(node);\r\n  }\r\n\r\n  function _removeNode(id) {\r\n    let index = Utils.getIndexById(_objectPool, id);\r\n    let isNodeFound = index > -1;\r\n\r\n    if (isNodeFound) {\r\n      let node = _objectPool.splice(index, 1)[0];\r\n\r\n      node.dispose();\r\n    }\r\n    return isNodeFound;\r\n  }\r\n\r\n  function _getNodesByClass(className) {\r\n    return _objectPool.filter((node) => {\r\n      return node.getData().class === className;\r\n      // return node.constructor.name === className;\r\n    });\r\n  }\r\n\r\n  function _getNodes(className = '') {\r\n    return className === '' ? _objectPool.slice() : _getNodesByClass(className);\r\n  }\r\n\r\n  function _getData() {\r\n    return _objectPool.map((obj) => {\r\n      return obj.getData ? obj.getData() : obj;\r\n    });\r\n  }\r\n\r\n  function _clearData() {\r\n    _objectPool.forEach(obj => obj.dispose());\r\n    _objectPool = [];\r\n  }\r\n\r\n  function _serialize() {\r\n    return JSON.stringify(_getData());\r\n  }\r\n\r\n  return {\r\n    findNode: _findNode,\r\n    addNode: _addNode,\r\n    removeNode: _removeNode,\r\n    getNodes: _getNodes,\r\n    getData: _getData,\r\n    serialize: _serialize,\r\n    clearData: _clearData\r\n  };\r\n};\r\n\r\nmodule.exports = NodePool;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/NodePool.js","'use strict';\r\n\r\nimport ErrorCode from './ErrorCode';\r\nimport BaseNode from './BaseNode';\r\nimport AnswerNode from '../dialogs/AnswerNode';\r\nimport DialogNode from '../dialogs/DialogNode';\r\nimport TalkNode from '../dialogs/TalkNode';\r\n\r\nconst NodeFactory = function (nodePool, errorHandler) {\r\n\r\n  const _nodePool = nodePool;\r\n  const _errorHandler = errorHandler;\r\n\r\n  function _createNode(data) {\r\n    let className = data.class;\r\n\r\n    // console.log('_createNode',_nodePool);\r\n    switch (className) {\r\n      case 'BaseNode': return new BaseNode(_nodePool, data);\r\n      case 'AnswerNode': return new AnswerNode(_nodePool, data);\r\n      case 'DialogNode': return new DialogNode(_nodePool, data);\r\n      case 'TalkNode': return new TalkNode(_nodePool, data);\r\n      default:\r\n        _errorHandler.showMsg(ErrorCode.CLASS_NOT_DEFINED, {class: className});\r\n        return null;\r\n    }\r\n  }\r\n\r\n  return {\r\n    createNode: _createNode\r\n  };\r\n};\r\n\r\nmodule.exports = NodeFactory;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/NodeFactory.js","'use strict';\r\n\r\nimport ErrorCode from './ErrorCode';\r\n\r\nconst NodeCreator = function (nodePool, nodeFactory, errorHandler) {\r\n  const _nodePool = nodePool,\r\n    _nodeFactory = nodeFactory,\r\n    _errorHandler = errorHandler;\r\n\r\n  let _lastChild = null,\r\n    _parentHistory = [],\r\n    _tempWires = [];\r\n\r\n  function _setConnection(type, nodeId1, nodeId2) {\r\n    if (nodeId1 === nodeId2) {\r\n      _errorHandler.showMsg(ErrorCode.CONNECTION_TO_ITSELF, {node: nodeId1});\r\n    }\r\n\r\n    let node1 = _nodePool.findNode(nodeId1);\r\n    let node2 = _nodePool.findNode(nodeId2);\r\n\r\n    if (node2 === null) {\r\n      _tempWires.push({type: type, targetNode: nodeId1, referenceNode: nodeId2});\r\n      return;\r\n    }\r\n\r\n    if (node1.canRecieveWire(type) && node2.canBeWiredTo(type)) {\r\n      node1.addWire(type, node2.getId());\r\n    } else {\r\n      _errorHandler.showMsg(ErrorCode.IMPROPER_CONNECTION, {\r\n        type: type,\r\n        node1: nodeId1,\r\n        node2: nodeId2\r\n      });\r\n    }\r\n  }\r\n\r\n  function _getWaitingWiresForNode(nodeId) {\r\n    let wires = [], i;\r\n\r\n    for (i = _tempWires.length - 1; i >= 0 ; i--) {\r\n      if (_tempWires[i].referenceNode === nodeId) {\r\n        wires.push(_tempWires.splice(i, 1)[0]);\r\n      }\r\n    }\r\n    return wires;\r\n  }\r\n\r\n  /**\r\n   * This method helps in the creation of nodes. Its focus on proper\r\n   * placement of nodes in tree.\r\n   * @param  {object} params  Parameters of created node.\r\n   * @param  {boolean} asChild Determines if node should be added as child\r\n   * of another node or as an independent node.\r\n   */\r\n  function _nodeCreator(params, asChild) {\r\n    function createChildNode(nodeParams) {\r\n      // We create a new node, and then set as the last child.\r\n      _lastChild = _nodeFactory.createNode(nodeParams);\r\n      // Then we add our freshly created node to its parent.\r\n      _parentHistory[0].addChild(_lastChild.getId());\r\n      // Finally new node is added to main storage object.\r\n      _nodePool.addNode(_lastChild);\r\n    }\r\n    // Test if node should be added as child or parent.\r\n    if (asChild) {\r\n      // If last added child was not null then we must check additional conditions.\r\n      if (_lastChild !== null) {\r\n        // If constructor name of previous child node, is equal to name of class,\r\n        // whose we try to create, it means node should be added to current parent.\r\n        if (_lastChild.getData().class === params.class) {\r\n          createChildNode(params);\r\n        // If names of constructors not match, then we must check if new node\r\n        // can be added as child to our previous child.\r\n        } else if (_lastChild.canAddChild(params.class)) {\r\n          _parentHistory.unshift(_lastChild);\r\n          createChildNode(params);\r\n        // Finally if previous conditions are false we try go back to previous\r\n        // parent node.\r\n        } else {\r\n          _lastChild = _parentHistory.shift() || null;\r\n          _nodeCreator(params, asChild);\r\n        }\r\n      // If last child is null, then we check if node can be added to current\r\n      // parent node.\r\n      } else if (_parentHistory.length > 0 && _parentHistory[0].canAddChild(params.class)) {\r\n        createChildNode(params);\r\n      // If last child and last parent is equal to null, then new child node\r\n      // cant be added, so we throw error.\r\n      } else {\r\n        _errorHandler.showMsg(ErrorCode.INCOMPATIBLE_CHILD, {\r\n          child: params.class,\r\n          parent: _parentHistory.length > 0 ?\r\n                  _parentHistory[0].getData().class : 'null'\r\n        });\r\n      }\r\n    } else {\r\n      // If node is added as parent, then last child is set to null\r\n      // and parent history is cleared.\r\n      _lastChild = null;\r\n      _parentHistory.length = 0;\r\n      // After that, new node is created.\r\n      let node = _nodeFactory.createNode(params);\r\n\r\n      _parentHistory = [node];\r\n      _nodePool.addNode(node);\r\n    }\r\n\r\n    _getWaitingWiresForNode(params.uuid).map((wire) => {\r\n      _setConnection(wire.type, wire.targetNode, wire.referenceNode);\r\n    });\r\n  }\r\n\r\n  function _addNode(className, params = {}) {\r\n    let _params = params;\r\n\r\n    _params.class = className;\r\n    _nodeCreator(_params, false);\r\n    return this;\r\n  }\r\n\r\n  function _addDialog(id = _errorHandler.showMsg(ErrorCode.MANDATORY_PARAM,\r\n                                {param: 'id'})) {\r\n    let params = {\r\n      uuid: id,\r\n      class: 'DialogNode'\r\n    };\r\n\r\n    _nodeCreator(params, false);\r\n    return this;\r\n  }\r\n\r\n  function _addTalk(id = _errorHandler.showMsg(ErrorCode.MANDATORY_PARAM,\r\n                                {param: 'id'}), text = '') {\r\n    let params = {\r\n      uuid: id,\r\n      text: text,\r\n      class: 'TalkNode'\r\n    };\r\n\r\n    _nodeCreator(params, true);\r\n    return this;\r\n  }\r\n\r\n  function _addAnswer(text = '') {\r\n    let params = {\r\n      text: text,\r\n      class: 'AnswerNode'\r\n    };\r\n\r\n    _nodeCreator(params, true);\r\n    return this;\r\n  }\r\n\r\n  function _addWire(type, referenceNodeId) {\r\n    let targetNode = _lastChild;\r\n\r\n    if (targetNode === null && _parentHistory.length > 0) {\r\n      targetNode = _parentHistory[0];\r\n    } else {\r\n      /* _errorHandler.showMsg(ErrorCode.INCOMPATIBLE_CHILD,{\r\n        child:className,\r\n        parent: _parentHistory.length > 0\r\n              ? _parentHistory[0].constructor.name\r\n              : 'null'\r\n      });*/\r\n    }\r\n    _setConnection(type, targetNode.getId(), referenceNodeId);\r\n    return this;\r\n  }\r\n\r\n  return {\r\n    addNode: _addNode,\r\n    addDialog: _addDialog,\r\n    addTalk: _addTalk,\r\n    addAnswer: _addAnswer,\r\n    addWire: _addWire\r\n  };\r\n\r\n};\r\n\r\nmodule.exports = NodeCreator;\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/rpgs/core/NodeCreator.js"],"sourceRoot":""}