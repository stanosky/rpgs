/*!
 * rpgs
 * RPG System
 * https://github.com/stanosky/rpgs
 * @author Krzysztof Stano
 * @version 1.0.0
 * Copyright 2016. MIT licensed.
 */
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _UniqueObject2 = require('../core/UniqueObject');

var _UniqueObject3 = _interopRequireDefault(_UniqueObject2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Actor = function () {
  //Weak maps are new feature to JavaScript. We can store private
  //object properties in key/value pairs using our instance as the key,
  //and our class can capture those key/value maps in a closure.
  var _name = new WeakMap();
  var _dialog = new WeakMap();
  var _inventory = new WeakMap();

  return function (_UniqueObject) {
    _inherits(Actor, _UniqueObject);

    function Actor(id) {
      _classCallCheck(this, Actor);

      var _this = _possibleConstructorReturn(this, (Actor.__proto__ || Object.getPrototypeOf(Actor)).call(this, id));

      _name.set(_this, '');
      _dialog.set(_this, null);
      _inventory.set(_this, null);
      return _this;
    }

    _createClass(Actor, [{
      key: 'setName',
      value: function setName(value) {
        _name.set(this, value);
      }
    }, {
      key: 'getName',
      value: function getName() {
        return _name.get(this);
      }
    }, {
      key: 'setDialog',
      value: function setDialog(dialog) {
        _dialog.set(this, dialog);
      }
    }, {
      key: 'getDialog',
      value: function getDialog() {
        return _dialog.get(this);
      }
    }, {
      key: 'setInventory',
      value: function setInventory(inventory) {
        _inventory.set(this, inventory);
      }
    }, {
      key: 'getInventory',
      value: function getInventory() {
        return _inventory.get(this);
      }
    }]);

    return Actor;
  }(_UniqueObject3.default);
}();

module.exports = Actor;

},{"../core/UniqueObject":3}],2:[function(require,module,exports){
"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _UniqueObject2 = require('./UniqueObject');

var _UniqueObject3 = _interopRequireDefault(_UniqueObject2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var BaseObject = function (id) {
  //Weak maps are new feature to JavaScript. We can store private
  //object properties in key/value pairs using our instance as the key,
  //and our class can capture those key/value maps in a closure.
  var _visible = new WeakMap();
  var _active = new WeakMap();

  return function (_UniqueObject) {
    _inherits(BaseObject, _UniqueObject);

    function BaseObject(id) {
      _classCallCheck(this, BaseObject);

      var _this = _possibleConstructorReturn(this, (BaseObject.__proto__ || Object.getPrototypeOf(BaseObject)).call(this, id));

      _visible.set(_this, null);
      _active.set(_this, null);
      return _this;
    }
    /**
     * Method sets condition that must be met in order to node was visible.
     * @param {Condition} condition Instance of Condition object
     */


    _createClass(BaseObject, [{
      key: 'setVisibleCondition',
      value: function setVisibleCondition(condition) {
        _visible.set(this, BaseObject.isConditionInstance(condition));
      }

      /**
       * Returns boolean that reflects visiblility state of node.
       * @return {Boolean} Visibility state
       */

    }, {
      key: 'isVisible',
      value: function isVisible() {
        return BaseObject.checkCondition(_visible.get(this));
      }

      /**
       * Method sets condition that must be met in order to node was active.
       * @param {Condition} condition Instance of Condition object
       */

    }, {
      key: 'setActiveCondition',
      value: function setActiveCondition(condition) {
        _active.set(this, BaseObject.isConditionInstance(condition));
      }

      /**
       * Returns boolean that reflects activity state of node.
       * @return {Boolean} Active state
       */

    }, {
      key: 'isActive',
      value: function isActive() {
        return BaseObject.checkCondition(_active.get(this));
      }
    }], [{
      key: 'checkCondition',
      value: function checkCondition(condition) {
        if (condition === null) return true;
        return condition.check();
      }
    }, {
      key: 'isConditionInstance',
      value: function isConditionInstance(obj) {
        if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== Condition) {
          throw new Error('Wrong type of object passed. Expected "Condition" object.');
          return null;
        }
        return obj;
      }
    }]);

    return BaseObject;
  }(_UniqueObject3.default);
}();
module.exports = BaseObject;

},{"./UniqueObject":3}],3:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _Utils = require("./Utils");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var UniqueObject = function () {
  //Weak maps are new feature to JavaScript. We can store private
  //object properties in key/value pairs using our instance as the key,
  //and our class can capture those key/value maps in a closure.
  var _uuid = new WeakMap();

  return function () {
    function UniqueObject(id) {
      _classCallCheck(this, UniqueObject);

      //By default we assign Universally Unique ID
      _uuid.set(this, id || _Utils.UUID.generate());
    }

    _createClass(UniqueObject, [{
      key: "setId",
      value: function setId(value) {
        _uuid.set(this, value);
      }
    }, {
      key: "getId",
      value: function getId() {
        return _uuid.get(this);
      }
    }]);

    return UniqueObject;
  }();
}();
module.exports = UniqueObject;

},{"./Utils":4}],4:[function(require,module,exports){
"use strict";

/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var UUID = function () {
  var self = {};
  var lut = [];for (var i = 0; i < 256; i++) {
    lut[i] = (i < 16 ? '0' : '') + i.toString(16);
  }
  self.generate = function () {
    var d0 = Math.random() * 0xffffffff | 0;
    var d1 = Math.random() * 0xffffffff | 0;
    var d2 = Math.random() * 0xffffffff | 0;
    var d3 = Math.random() * 0xffffffff | 0;
    return lut[d0 & 0xff] + lut[d0 >> 8 & 0xff] + lut[d0 >> 16 & 0xff] + lut[d0 >> 24 & 0xff] + '-' + lut[d1 & 0xff] + lut[d1 >> 8 & 0xff] + '-' + lut[d1 >> 16 & 0x0f | 0x40] + lut[d1 >> 24 & 0xff] + '-' + lut[d2 & 0x3f | 0x80] + lut[d2 >> 8 & 0xff] + '-' + lut[d2 >> 16 & 0xff] + lut[d2 >> 24 & 0xff] + lut[d3 & 0xff] + lut[d3 >> 8 & 0xff] + lut[d3 >> 16 & 0xff] + lut[d3 >> 24 & 0xff];
  };
  return self;
}();

exports.UUID = UUID;

var indexOfObject = function indexOfObject(array, obj) {
  for (var i = 0; i < array.length; i++) {
    if (array[i] === obj) return i;
  }
  return -1;
};

exports.indexOfObject = indexOfObject;

exports.getObjectById = function (array, id) {
  for (var i = 0; i < array.length; i++) {
    if (array[i].getId() === id) return array[i];
  }
  return null;
};

var getIndexById = function getIndexById(array, id) {
  for (var i = 0; i < array.length; i++) {
    if (array[i].getId() === id) return i;
  }
  return -1;
};
exports.getIndexById = getIndexById;

exports.addObjectToArray = function (array, obj, expectedType) {
  if (expectedType !== undefined && expectedType !== null) {
    if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== expectedType) {
      throw new Error('Wrong type of object passed. Expected ' + expectedType.toString() + ' object.');
    }
  }
  if (indexOfObject(array, obj) === -1) {
    array.push(obj);
  }
  return array;
};

exports.removeObjectById = function (array, id) {
  var index = getIndexById(array, id);
  if (index !== -1) {
    array.splice(index, 1);
  }
};

exports.removeObjectFromArray = function (array, obj) {
  var index = indexOfObject(array, obj);
  if (index !== -1) {
    array.splice(index, 1);
  }
};

},{}],5:[function(require,module,exports){
"use strict";

var _Utils = require('./rpgs/core/Utils');

var _Utils2 = _interopRequireDefault(_Utils);

var _UniqueObject = require('./rpgs/core/UniqueObject');

var _UniqueObject2 = _interopRequireDefault(_UniqueObject);

var _BaseObject = require('./rpgs/core/BaseObject');

var _BaseObject2 = _interopRequireDefault(_BaseObject);

var _Actor = require('./rpgs/actors/Actor');

var _Actor2 = _interopRequireDefault(_Actor);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

(function ($, window, document, undefined) {
      $(function () {
            var uniqueObject = new _UniqueObject2.default();
            console.log('uniqueObject.getId()', uniqueObject.getId());

            var baseObject = new _BaseObject2.default();
            console.log('baseObject.isVisible()', baseObject.isVisible());
            console.log('baseObject.isActive()', baseObject.isActive());
            console.log('baseObject.getId()', baseObject.getId());

            var actor = new _Actor2.default();
            console.log('actor.getId()', actor.getId());
            actor.setName('Adam');
            console.log('actor.getName()', actor.getName());

            var myWeakMap = new WeakMap().set(this, ['a']);
            console.log('weakmap test1:', myWeakMap.get(this));
            myWeakMap.set(this, _Utils2.default.addObjectToArray(myWeakMap.get(this), 'b'));
            console.log('weakmap test2:', myWeakMap.get(this));
      });
})(jQuery, window, document);

},{"./rpgs/actors/Actor":1,"./rpgs/core/BaseObject":2,"./rpgs/core/UniqueObject":3,"./rpgs/core/Utils":4}]},{},[5])


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvcnBncy9hY3RvcnMvQWN0b3IuanMiLCJzcmMvanMvcnBncy9jb3JlL0Jhc2VPYmplY3QuanMiLCJzcmMvanMvcnBncy9jb3JlL1VuaXF1ZU9iamVjdC5qcyIsInNyYy9qcy9ycGdzL2NvcmUvVXRpbHMuanMiLCJzcmMvanMvc2NyaXB0cy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FDQUE7Ozs7QUFDQTs7Ozs7Ozs7Ozs7O0FBRUEsSUFBSSxRQUFTLFlBQVc7QUFDdEI7QUFDQTtBQUNBO0FBQ0EsTUFBSSxRQUFRLElBQUksT0FBSixFQUFaO0FBQ0EsTUFBSSxVQUFVLElBQUksT0FBSixFQUFkO0FBQ0EsTUFBSSxhQUFhLElBQUksT0FBSixFQUFqQjs7QUFFQTtBQUFBOztBQUNFLG1CQUFZLEVBQVosRUFBZ0I7QUFBQTs7QUFBQSxnSEFDUixFQURROztBQUVkLFlBQU0sR0FBTixRQUFlLEVBQWY7QUFDQSxjQUFRLEdBQVIsUUFBaUIsSUFBakI7QUFDQSxpQkFBVyxHQUFYLFFBQW9CLElBQXBCO0FBSmM7QUFLZjs7QUFOSDtBQUFBO0FBQUEsOEJBUVUsS0FSVixFQVFpQjtBQUNiLGNBQU0sR0FBTixDQUFVLElBQVYsRUFBZSxLQUFmO0FBQ0Q7QUFWSDtBQUFBO0FBQUEsZ0NBWVk7QUFDUixlQUFPLE1BQU0sR0FBTixDQUFVLElBQVYsQ0FBUDtBQUNEO0FBZEg7QUFBQTtBQUFBLGdDQWdCWSxNQWhCWixFQWdCb0I7QUFDaEIsZ0JBQVEsR0FBUixDQUFZLElBQVosRUFBaUIsTUFBakI7QUFDRDtBQWxCSDtBQUFBO0FBQUEsa0NBb0JjO0FBQ1YsZUFBTyxRQUFRLEdBQVIsQ0FBWSxJQUFaLENBQVA7QUFDRDtBQXRCSDtBQUFBO0FBQUEsbUNBd0JlLFNBeEJmLEVBd0IwQjtBQUN0QixtQkFBVyxHQUFYLENBQWUsSUFBZixFQUFvQixTQUFwQjtBQUNE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aUJBQVosRUFBOEIsTUFBTSxPQUFOLEVBQTlCOztBQUVBLGdCQUFJLFlBQVksSUFBSSxPQUFKLEdBQWMsR0FBZCxDQUFrQixJQUFsQixFQUF1QixDQUFDLEdBQUQsQ0FBdkIsQ0FBaEI7QUFDQSxvQkFBUSxHQUFSLENBQVksZ0JBQVosRUFBNkIsVUFBVSxHQUFWLENBQWMsSUFBZCxDQUE3QjtBQUNBLHNCQUFVLEdBQVYsQ0FBYyxJQUFkLEVBQW1CLGdCQUFNLGdCQUFOLENBQXVCLFVBQVUsR0FBVixDQUFjLElBQWQsQ0FBdkIsRUFBMkMsR0FBM0MsQ0FBbkI7QUFDQSxvQkFBUSxHQUFSLENBQVksZ0JBQVosRUFBNkIsVUFBVSxHQUFWLENBQWMsSUFBZCxDQUE3QjtBQUVILE9BbkJEO0FBcUJELENBdEJELEVBc0JHLE1BdEJILEVBc0JXLE1BdEJYLEVBc0JtQixRQXRCbkIiLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlwidXNlIHN0cmljdFwiO1xyXG5pbXBvcnQgVW5pcXVlT2JqZWN0IGZyb20gJy4uL2NvcmUvVW5pcXVlT2JqZWN0JztcclxuXHJcbmxldCBBY3RvciA9IChmdW5jdGlvbigpIHtcclxuICAvL1dlYWsgbWFwcyBhcmUgbmV3IGZlYXR1cmUgdG8gSmF2YVNjcmlwdC4gV2UgY2FuIHN0b3JlIHByaXZhdGVcclxuICAvL29iamVjdCBwcm9wZXJ0aWVzIGluIGtleS92YWx1ZSBwYWlycyB1c2luZyBvdXIgaW5zdGFuY2UgYXMgdGhlIGtleSxcclxuICAvL2FuZCBvdXIgY2xhc3MgY2FuIGNhcHR1cmUgdGhvc2Uga2V5L3ZhbHVlIG1hcHMgaW4gYSBjbG9zdXJlLlxyXG4gIGxldCBfbmFtZSA9IG5ldyBXZWFrTWFwKCk7XHJcbiAgbGV0IF9kaWFsb2cgPSBuZXcgV2Vha01hcCgpO1xyXG4gIGxldCBfaW52ZW50b3J5ID0gbmV3IFdlYWtNYXAoKTtcclxuXHJcbiAgcmV0dXJuIGNsYXNzIEFjdG9yIGV4dGVuZHMgVW5pcXVlT2JqZWN0IHtcclxuICAgIGNvbnN0cnVjdG9yKGlkKSB7XHJcbiAgICAgIHN1cGVyKGlkKTtcclxuICAgICAgX25hbWUuc2V0KHRoaXMsJycpO1xyXG4gICAgICBfZGlhbG9nLnNldCh0aGlzLG51bGwpO1xyXG4gICAgICBfaW52ZW50b3J5LnNldCh0aGlzLG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldE5hbWUodmFsdWUpIHtcclxuICAgICAgX25hbWUuc2V0KHRoaXMsdmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE5hbWUoKSB7XHJcbiAgICAgIHJldHVybiBfbmFtZS5nZXQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RGlhbG9nKGRpYWxvZykge1xyXG4gICAgICBfZGlhbG9nLnNldCh0aGlzLGRpYWxvZyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlhbG9nKCkge1xyXG4gICAgICByZXR1cm4gX2RpYWxvZy5nZXQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SW52ZW50b3J5KGludmVudG9yeSkge1xyXG4gICAgICBfaW52ZW50b3J5LnNldCh0aGlzLGludmVudG9yeSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW52ZW50b3J5KCkge1xyXG4gICAgICByZXR1cm4gX2ludmVudG9yeS5nZXQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQWN0b3I7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xuaW1wb3J0IFVuaXF1ZU9iamVjdCBmcm9tICcuL1VuaXF1ZU9iamVjdCc7XHJcblxyXG5sZXQgQmFzZU9iamVjdCA9IChmdW5jdGlvbihpZCkge1xyXG4gIC8vV2VhayBtYXBzIGFyZSBuZXcgZmVhdHVyZSB0byBKYXZhU2NyaXB0LiBXZSBjYW4gc3RvcmUgcHJpdmF0ZVxyXG4gIC8vb2JqZWN0IHByb3BlcnRpZXMgaW4ga2V5L3ZhbHVlIHBhaXJzIHVzaW5nIG91ciBpbnN0YW5jZSBhcyB0aGUga2V5LFxyXG4gIC8vYW5kIG91ciBjbGFzcyBjYW4gY2FwdHVyZSB0aG9zZSBrZXkvdmFsdWUgbWFwcyBpbiBhIGNsb3N1cmUuXHJcbiAgbGV0IF92aXNpYmxlID0gbmV3IFdlYWtNYXAoKTtcclxuICBsZXQgX2FjdGl2ZSA9IG5ldyBXZWFrTWFwKCk7XHJcblxyXG4gIHJldHVybiBjbGFzcyBCYXNlT2JqZWN0IGV4dGVuZHMgVW5pcXVlT2JqZWN0IHtcclxuICAgIGNvbnN0cnVjdG9yKGlkKSB7XHJcbiAgICAgIHN1cGVyKGlkKTtcclxuICAgICAgX3Zpc2libGUuc2V0KHRoaXMsbnVsbCk7XHJcbiAgICAgIF9hY3RpdmUuc2V0KHRoaXMsbnVsbCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE1ldGhvZCBzZXRzIGNvbmRpdGlvbiB0aGF0IG11c3QgYmUgbWV0IGluIG9yZGVyIHRvIG5vZGUgd2FzIHZpc2libGUuXHJcbiAgICAgKiBAcGFyYW0ge0NvbmRpdGlvbn0gY29uZGl0aW9uIEluc3RhbmNlIG9mIENvbmRpdGlvbiBvYmplY3RcclxuICAgICAqL1xyXG4gICAgc2V0VmlzaWJsZUNvbmRpdGlvbihjb25kaXRpb24pIHtcclxuICAgICAgX3Zpc2libGUuc2V0KHRoaXMsQmFzZU9iamVjdC5pc0NvbmRpdGlvbkluc3RhbmNlKGNvbmRpdGlvbikpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBib29sZWFuIHRoYXQgcmVmbGVjdHMgdmlzaWJsaWxpdHkgc3RhdGUgb2Ygbm9kZS5cclxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IFZpc2liaWxpdHkgc3RhdGVcclxuICAgICAqL1xyXG4gICAgaXNWaXNpYmxlKCkge1xyXG4gICAgICByZXR1cm4gQmFzZU9iamVjdC5jaGVja0NvbmRpdGlvbihfdmlzaWJsZS5nZXQodGhpcykpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIHNldHMgY29uZGl0aW9uIHRoYXQgbXVzdCBiZSBtZXQgaW4gb3JkZXIgdG8gbm9kZSB3YXMgYWN0aXZlLlxyXG4gICAgICogQHBhcmFtIHtDb25kaXRpb259IGNvbmRpdGlvbiBJbnN0YW5jZSBvZiBDb25kaXRpb24gb2JqZWN0XHJcbiAgICAgKi9cclxuICAgIHNldEFjdGl2ZUNvbmRpdGlvbihjb25kaXRpb24pIHtcclxuICAgICAgX2FjdGl2ZS5zZXQodGhpcyxCYXNlT2JqZWN0LmlzQ29uZGl0aW9uSW5zdGFuY2UoY29uZGl0aW9uKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGJvb2xlYW4gdGhhdCByZWZsZWN0cyBhY3Rpdml0eSBzdGF0ZSBvZiBub2RlLlxyXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gQWN0aXZlIHN0YXRlXHJcbiAgICAgKi9cclxuICAgIGlzQWN0aXZlKCkge1xyXG4gICAgICByZXR1cm4gQmFzZU9iamVjdC5jaGVja0NvbmRpdGlvbihfYWN0aXZlLmdldCh0aGlzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGNoZWNrQ29uZGl0aW9uKGNvbmRpdGlvbikge1xyXG4gICAgICBpZihjb25kaXRpb24gPT09IG51bGwpIHJldHVybiB0cnVlO1xyXG4gICAgICByZXR1cm4gY29uZGl0aW9uLmNoZWNrKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGlzQ29uZGl0aW9uSW5zdGFuY2Uob2JqKSB7XHJcbiAgICAgIGlmKHR5cGVvZiBvYmogIT09IENvbmRpdGlvbikge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgdHlwZSBvZiBvYmplY3QgcGFzc2VkLiBFeHBlY3RlZCBcIkNvbmRpdGlvblwiIG9iamVjdC4nKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG4gIH07XHJcbn0pKCk7XHJcbm1vZHVsZS5leHBvcnRzID0gQmFzZU9iamVjdDtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbmltcG9ydCB7VVVJRH0gZnJvbSAnLi9VdGlscyc7XHJcblxyXG5sZXQgVW5pcXVlT2JqZWN0ID0gKGZ1bmN0aW9uKCl7XHJcbiAgLy9XZWFrIG1hcHMgYXJlIG5ldyBmZWF0dXJlIHRvIEphdmFTY3JpcHQuIFdlIGNhbiBzdG9yZSBwcml2YXRlXHJcbiAgLy9vYmplY3QgcHJvcGVydGllcyBpbiBrZXkvdmFsdWUgcGFpcnMgdXNpbmcgb3VyIGluc3RhbmNlIGFzIHRoZSBrZXksXHJcbiAgLy9hbmQgb3VyIGNsYXNzIGNhbiBjYXB0dXJlIHRob3NlIGtleS92YWx1ZSBtYXBzIGluIGEgY2xvc3VyZS5cclxuICBsZXQgX3V1aWQgPSBuZXcgV2Vha01hcCgpO1xyXG5cclxuICByZXR1cm4gY2xhc3MgVW5pcXVlT2JqZWN0IHtcclxuICAgIGNvbnN0cnVjdG9yKGlkKSB7XHJcbiAgICAgIC8vQnkgZGVmYXVsdCB3ZSBhc3NpZ24gVW5pdmVyc2FsbHkgVW5pcXVlIElEXHJcbiAgICAgIF91dWlkLnNldCh0aGlzLGlkfHxVVUlELmdlbmVyYXRlKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldElkKHZhbHVlKSB7XHJcbiAgICAgIF91dWlkLnNldCh0aGlzLHZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRJZCgpIHtcclxuICAgICAgcmV0dXJuIF91dWlkLmdldCh0aGlzKTtcclxuICAgIH1cclxuICB9O1xyXG59KSgpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IFVuaXF1ZU9iamVjdDtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogRmFzdCBVVUlEIGdlbmVyYXRvciwgUkZDNDEyMiB2ZXJzaW9uIDQgY29tcGxpYW50LlxyXG4gKiBAYXV0aG9yIEplZmYgV2FyZCAoamN3YXJkLmNvbSkuXHJcbiAqIEBsaWNlbnNlIE1JVCBsaWNlbnNlXHJcbiAqIEBsaW5rIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTA1MDM0L2hvdy10by1jcmVhdGUtYS1ndWlkLXV1aWQtaW4tamF2YXNjcmlwdC8yMTk2MzEzNiMyMTk2MzEzNlxyXG4gKiovXHJcbnZhciBVVUlEID0gKGZ1bmN0aW9uKCkge1xyXG4gIHZhciBzZWxmID0ge307XHJcbiAgdmFyIGx1dCA9IFtdOyBmb3IgKHZhciBpPTA7IGk8MjU2OyBpKyspIHsgbHV0W2ldID0gKGk8MTY/JzAnOicnKSsoaSkudG9TdHJpbmcoMTYpOyB9XHJcbiAgc2VsZi5nZW5lcmF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGQwID0gTWF0aC5yYW5kb20oKSoweGZmZmZmZmZmfDA7XHJcbiAgICB2YXIgZDEgPSBNYXRoLnJhbmRvbSgpKjB4ZmZmZmZmZmZ8MDtcclxuICAgIHZhciBkMiA9IE1hdGgucmFuZG9tKCkqMHhmZmZmZmZmZnwwO1xyXG4gICAgdmFyIGQzID0gTWF0aC5yYW5kb20oKSoweGZmZmZmZmZmfDA7XHJcbiAgICByZXR1cm4gbHV0W2QwJjB4ZmZdK2x1dFtkMD4+OCYweGZmXStsdXRbZDA+PjE2JjB4ZmZdK2x1dFtkMD4+MjQmMHhmZl0rJy0nK1xyXG4gICAgICBsdXRbZDEmMHhmZl0rbHV0W2QxPj44JjB4ZmZdKyctJytsdXRbZDE+PjE2JjB4MGZ8MHg0MF0rbHV0W2QxPj4yNCYweGZmXSsnLScrXHJcbiAgICAgIGx1dFtkMiYweDNmfDB4ODBdK2x1dFtkMj4+OCYweGZmXSsnLScrbHV0W2QyPj4xNiYweGZmXStsdXRbZDI+PjI0JjB4ZmZdK1xyXG4gICAgICBsdXRbZDMmMHhmZl0rbHV0W2QzPj44JjB4ZmZdK2x1dFtkMz4+MTYmMHhmZl0rbHV0W2QzPj4yNCYweGZmXTtcclxuICB9XHJcbiAgcmV0dXJuIHNlbGY7XHJcbn0pKCk7XHJcblxyXG5leHBvcnRzLlVVSUQgPSBVVUlEO1xyXG5cclxubGV0IGluZGV4T2ZPYmplY3QgPSBmdW5jdGlvbihhcnJheSxvYmopIHtcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICBpZihhcnJheVtpXSA9PT0gb2JqKSByZXR1cm4gaTtcclxuICB9XHJcbiAgcmV0dXJuIC0xO1xyXG59O1xyXG5cclxuZXhwb3J0cy5pbmRleE9mT2JqZWN0ID0gaW5kZXhPZk9iamVjdDtcclxuXHJcblxyXG5leHBvcnRzLmdldE9iamVjdEJ5SWQgPSBmdW5jdGlvbihhcnJheSxpZCkge1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgIGlmKGFycmF5W2ldLmdldElkKCkgPT09IGlkKSByZXR1cm4gYXJyYXlbaV07XHJcbiAgfVxyXG4gIHJldHVybiBudWxsO1xyXG59O1xyXG5cclxubGV0IGdldEluZGV4QnlJZCA9IGZ1bmN0aW9uKGFycmF5LGlkKSB7XHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgaWYoYXJyYXlbaV0uZ2V0SWQoKSA9PT0gaWQpIHJldHVybiBpO1xyXG4gIH1cclxuICByZXR1cm4gLTE7XHJcbn07XHJcbmV4cG9ydHMuZ2V0SW5kZXhCeUlkID0gZ2V0SW5kZXhCeUlkO1xyXG5cclxuZXhwb3J0cy5hZGRPYmplY3RUb0FycmF5ID0gZnVuY3Rpb24oYXJyYXksb2JqLGV4cGVjdGVkVHlwZSkge1xyXG4gIGlmKGV4cGVjdGVkVHlwZSAhPT0gdW5kZWZpbmVkICYmIGV4cGVjdGVkVHlwZSAhPT0gbnVsbCkge1xyXG4gICAgaWYodHlwZW9mIG9iaiAhPT0gZXhwZWN0ZWRUeXBlKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgdHlwZSBvZiBvYmplY3QgcGFzc2VkLiBFeHBlY3RlZCAnXHJcbiAgICAgICtleHBlY3RlZFR5cGUudG9TdHJpbmcoKSsnIG9iamVjdC4nKTtcclxuICAgIH1cclxuICB9XHJcbiAgaWYoaW5kZXhPZk9iamVjdChhcnJheSxvYmopID09PSAtMSkge1xyXG4gICAgYXJyYXkucHVzaChvYmopO1xyXG4gIH1cclxuICByZXR1cm4gYXJyYXk7XHJcbn07XHJcblxyXG5leHBvcnRzLnJlbW92ZU9iamVjdEJ5SWQgPSBmdW5jdGlvbihhcnJheSxpZCkge1xyXG4gIGxldCBpbmRleCA9IGdldEluZGV4QnlJZChhcnJheSxpZCk7XHJcbiAgaWYoaW5kZXggIT09IC0xKSB7XHJcbiAgICBhcnJheS5zcGxpY2UoaW5kZXgsMSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnRzLnJlbW92ZU9iamVjdEZyb21BcnJheSA9IGZ1bmN0aW9uKGFycmF5LG9iaikge1xyXG4gIGxldCBpbmRleCA9IGluZGV4T2ZPYmplY3QoYXJyYXksb2JqKTtcclxuICBpZihpbmRleCAhPT0gLTEpIHtcclxuICAgIGFycmF5LnNwbGljZShpbmRleCwxKTtcclxuICB9XHJcbn07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi9ycGdzL2NvcmUvVXRpbHMnO1xyXG5pbXBvcnQgVW5pcXVlT2JqZWN0IGZyb20gJy4vcnBncy9jb3JlL1VuaXF1ZU9iamVjdCc7XHJcbmltcG9ydCBCYXNlT2JqZWN0IGZyb20gJy4vcnBncy9jb3JlL0Jhc2VPYmplY3QnO1xyXG5pbXBvcnQgQWN0b3IgZnJvbSAnLi9ycGdzL2FjdG9ycy9BY3Rvcic7XHJcblxyXG4oZnVuY3Rpb24gKCQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xyXG4gICQoZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgdW5pcXVlT2JqZWN0ID0gbmV3IFVuaXF1ZU9iamVjdCgpO1xyXG4gICAgICBjb25zb2xlLmxvZygndW5pcXVlT2JqZWN0LmdldElkKCknLHVuaXF1ZU9iamVjdC5nZXRJZCgpKTtcclxuXHJcbiAgICAgIGxldCBiYXNlT2JqZWN0ID0gbmV3IEJhc2VPYmplY3QoKTtcclxuICAgICAgY29uc29sZS5sb2coJ2Jhc2VPYmplY3QuaXNWaXNpYmxlKCknLGJhc2VPYmplY3QuaXNWaXNpYmxlKCkpO1xyXG4gICAgICBjb25zb2xlLmxvZygnYmFzZU9iamVjdC5pc0FjdGl2ZSgpJyxiYXNlT2JqZWN0LmlzQWN0aXZlKCkpO1xyXG4gICAgICBjb25zb2xlLmxvZygnYmFzZU9iamVjdC5nZXRJZCgpJyxiYXNlT2JqZWN0LmdldElkKCkpO1xyXG5cclxuICAgICAgbGV0IGFjdG9yID0gbmV3IEFjdG9yKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdhY3Rvci5nZXRJZCgpJyxhY3Rvci5nZXRJZCgpKTtcclxuICAgICAgYWN0b3Iuc2V0TmFtZSgnQWRhbScpO1xyXG4gICAgICBjb25zb2xlLmxvZygnYWN0b3IuZ2V0TmFtZSgpJyxhY3Rvci5nZXROYW1lKCkpO1xyXG5cclxuICAgICAgbGV0IG15V2Vha01hcCA9IG5ldyBXZWFrTWFwKCkuc2V0KHRoaXMsWydhJ10pO1xyXG4gICAgICBjb25zb2xlLmxvZygnd2Vha21hcCB0ZXN0MTonLG15V2Vha01hcC5nZXQodGhpcykpO1xyXG4gICAgICBteVdlYWtNYXAuc2V0KHRoaXMsVXRpbHMuYWRkT2JqZWN0VG9BcnJheShteVdlYWtNYXAuZ2V0KHRoaXMpLCdiJykpO1xyXG4gICAgICBjb25zb2xlLmxvZygnd2Vha21hcCB0ZXN0MjonLG15V2Vha01hcC5nZXQodGhpcykpO1xyXG5cclxuICB9KTtcclxuXHJcbn0pKGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCk7XHJcbiJdfQ==
